{% extends "template_ref.html" %}
{% load static %}
{% load convert_markdown %}
{% block body %}
{% if user.is_authenticated %}
<header class="top-student" id="pagetop">    
    <section class="row dashboard justify-content-center align-items-center slidefromleft" id="dash-student">
        <div class="row py-2 col-lg-10 justify-content-center">
            <div class="row col-lg-3 justify-content-center text-center" id="pad-link">
                <button class="pad-box  fs-6 text-light mx-auto bg-pad" id="getLink">
                    <img src="{% static 'assets/img/logo/link.png' %}" class="px-3 pt-1 pad-logo"></br>
                    <p class="fs-6 mt-2 text-center" id="pad-title">Liens utiles</p>
                </button>
            </div>
            <div class="row justify-content-center text-center" id="pad-ticket">
                <button class="pad-box fs-6 text-light mx-auto bg-pad" id="getTickets">
                    {% if ticket %}
                    <div class="pad-notif-center bg-green">{{ ticket.open }}</div> 
                    {% endif %}
                    <img src="{% static 'assets/img/logo/ticket.png' %}" class="px-3 pt-1 pad-logo"></br>
                    <p class="fs-6 mt-2 text-center" id="pad-title">Mes tickets d'aide</p>
                </button>
            </div>
            <!-- <div class="row col-lg-3 justify-content-center text-center">
                <button class="pad-box fs-6 text-light mx-auto bg-pad">
                    <a href="/chat/public_chat" target="_blanck">
                    <img src="{% static 'assets/img/logo/chat.png' %}" class="px-3 pt-1 pad-logo"></br></a>
                    <p class="fs-6 mt-2 text-center" id="pad-title">Chat publique</p>
                </button>
            </div> -->
            <div class="row justify-content-center text-center"id="pad-account" onclick="window.location.replace('monCompte')">
                <button class="pad-box fs-6 text-light mx-auto bg-pad">
                    <img src="{% static 'assets/img/logo/account.png' %}" class="px-3 pt-1 pad-logo"></br>
                    <p class="fs-6 mt-2 text-center" id="pad-title">Mon compte</p>
                </button>
            </div>
            <div class="row justify-content-center text-center" onclick="window.location.replace('log_out')" id="pad-account">
                <div class="pad-box fs-6 text-light mx-auto bg-pad row align-content-center">
                    <img src="{% static 'assets/img/logo/logout.png' %}" class="px-3 pad-logo" id=""></br>
                    <p class="fs-6 mt-2 text-center" id="pad-title">Se déconnecter</p>
                </div>
            </div>
        </div>
    </section>
</header>
<section class="row text-dark slidefromleft justify-content-center">
    <h3 class="text-primary py-1 mt-2 text-center title_after w-75 h-100">F.A.Q</h3>
    <div class="row justify-content-center">
        {% for qr in faq %}
        <div class="col-lg-7 text-dark fs-5 mb-4">
            <div class="bg-grey fs-5 px-3 py-3">
                <h4>{{ qr.question }}</h4>
                {{ qr.response|convert_markdown|safe }}
            </div>
        </div>
        {% endfor %}
    </div>
</section>
<!-- Link section -->
<section class="row text-dark slidefromleft justify-content-center" id="block-link">
    <h3 class="text-primary py-1 mt-2 text-center title_after w-75">Liens utiles</h3>
    <div class="row justify-content-center">
        {% for linkloaded in links %}
        <div class="col-lg-7 text-dark fs-5 mb-4">
            <div class="bg-grey fs-5 px-3 py-3">
                {{ linkloaded.title }}
                <a href="{{ linkloaded.link }}" target="_blank">Cliquez-ici</a>
            </div>
        </div>
        {% endfor %}
    </div>
</section>
<!-- Ticket section -->
<section class="row text-dark pb-3 slidefromleft justify-content-center"  id="block-ticket">
    <h3 class="text-primary py-1 mt-2 text-center title_after w-75">Mes tickets d'aides</h3>
    <div class="container-fluid row dashboard justify-content-center">
        <div class="row pt-2 col-lg-10 justify-content-center">
            <button class="col-lg-2 btn my-1 mx-2 bg-primary text-light" id="createTicket">Créer un ticket</button>
            <button class="col-lg-2 btn my-1 mx-2 bg-primary text-light" id="showTickets">Voir mes tickets</button>
            <div class="mt-3 row justify-content-around">
                <div class="row col-lg-5">
                    <a id="form-ticket" action="" class="border-primary row justify-content-center form-group" style="display: none;">
                        <p class="fs-6 mt-2 text-primary text-center">Créer un ticket</p>
                        <input autocomplete='off' maxlength="29" type="text" id="ticket-title" class="form-control mt-1" placeholder="Titre"/>
                        <textarea id="ticket-text" autocomplete='off' type="text" name="message" class="form-control mt-1" placeholder="Exprimez votre besoin ici"></textarea>
                        <button class="col-lg-4 btn my-1 mx-2 bg-primary text-light" id="sendTicket">
                            Envoyer
                        </button>
                    </a>
                </div>
                <div class="row col-lg-5 border-primary justify-content-center text-start" style="display: none;" id="myTickets">
                    <p class="fs-6 mt-2 text-primary text-center">Mes tickets</p>
                    <div class="col-lg-12 row mb-3 " id="box-ticket">
                    {% for ticket in tickets %}
                        <a href="/ticket?id={{ticket.id}}" class="col-lg-8">{{ ticket.title }}</a>
                        {% if ticket.state == 0 %}
                        <div class="col-lg-3">Fermée</div>
                        {% else %}
                        <div class="col-lg-3">Ouvert</div>
                        {% endif %}
                    {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% else %}
<div class="" id="connection-page">
    <div class="row px-0 justify-content-center w-100" id="box-signin">
        <div class="col-lg-3 row px-3 py-3 bg-light justify-content-center" id="signin-form">
            <form method="post" action="" class="px-3 py-3 form-group">
                {% csrf_token %}
                <div class="ml-sign fs-7 text-start">
                    Nom d'utilisateur
                    <input autocomplete='off' type="text" name="username" class="form-control mt-1" placeholder=""/>
                </div>
                <div class="ml-sign fs-7 text-start pt-2">
                    Mot de passe
                    <input autocomplete='off' type="password" name="password" class="form-control mt-1" placeholder="********"/>
                </div>
                <button class="mt-3 w-100  btn btn-lg text-light mx-auto bg-primary" type="submit" name="signup_btn">
                    Se connecter
                </button>
            </form></br>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}